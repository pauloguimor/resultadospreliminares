<!DOCTYPE html>
<html lang="pt-BR">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XPDH340MT4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XPDH340MT4');
</script>

<meta charset="UTF-8">
<title>Resultados ‚Äì SEE/MG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PapaParse -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#f4f6f8}
header,footer{position:fixed;left:0;right:0;background:#0b3c6d;color:#fff;z-index:100}
header{top:0;padding:14px;text-align:center;font-size:20px;font-weight:bold}
footer{bottom:0;padding:12px;text-align:center}

.container{padding:90px 10px 120px}
.controls{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}
select,input,button{padding:10px;font-size:16px}
select,input{flex:1}

.table-wrap{max-height:65vh;overflow:auto;background:#fff;border-radius:6px}
table{border-collapse:collapse;width:100%;min-width:900px}
th,td{border:1px solid #ccc;padding:8px;text-align:center;font-size:14px}
th{background:#eee;position:sticky;top:0}

.status-aprovado{background:#2ecc71;color:#fff;padding:4px 8px;border-radius:6px}
.status-outro{background:#aaa;color:#fff;padding:4px 8px;border-radius:6px}

.pix-btn{background:#2ecc71;color:#fff;border:none;padding:10px 18px;
border-radius:6px;font-size:16px;cursor:pointer;margin-top:6px}

#loading{text-align:center;font-size:18px;margin-top:40px}
#erro-container{display:none;text-align:center}

@media(max-width:768px){
table{min-width:700px}
th,td{font-size:12px;padding:6px}
}
</style>
</head>

<body>

<header>Resultados ‚Äì SEE/MG</header>

<div class="container">

<div class="controls">
<select id="selCargo" disabled></select>
<select id="selSRE" disabled></select>
<input id="busca" placeholder="Digite o nome do candidato">
<button onclick="aplicarFiltro()">Ver Resultado</button>
</div>

<div id="loading">Carregando dados‚Ä¶</div>

<div id="erro-container">
<p>N√£o foi poss√≠vel carregar automaticamente.</p>
<input type="file" accept=".csv" onchange="carregarManualmente(this)">
</div>

<p id="resultado-msg"></p>

<div id="tabela-container" style="display:none" class="table-wrap">
<table>
<thead>
<tr>
<th>ORDEM</th><th>NOME</th><th>CARGO</th><th>SRE</th>
<th>OBJETIVA</th><th>REDA√á√ÉO</th><th>T√çTULOS</th>
<th>TOTAL</th><th>SITUA√á√ÉO</th>
</tr>
</thead>
<tbody id="tbody-resultados"></tbody>
</table>
</div>

</div>

<footer>
üíô Sua doa√ß√£o mant√©m o projeto ativo e em constante melhoria.<br>
<strong>Chave Pix:</strong> pauloguimor@yahoo.com.br<br>

(qualquer valor faz diferen√ßa)<br>

<button class="pix-btn" onclick="copiarPix()">üíö Copiar Pix</button>
</footer>

<script>
let todosDados = [];

window.onload = function() {
  Papa.parse("dados.csv", {
    download:true,
    header:true,
    skipEmptyLines:true,
    encoding:"ISO-8859-1",
    complete:r=>sucessoCarregamento(r.data),
    error:()=>{
      document.getElementById('loading').style.display='none';
      document.getElementById('erro-container').style.display='block';
    }
  });
};

function carregarManualmente(input){
  if(input.files.length>0){
    Papa.parse(input.files[0],{
      header:true,
      skipEmptyLines:true,
      encoding:"ISO-8859-1",
      complete:r=>sucessoCarregamento(r.data)
    });
  }
}

function sucessoCarregamento(dados){
  todosDados=dados;
  document.getElementById('loading').style.display='none';

  const cargos=new Set(), sres=new Set();
  dados.forEach(l=>{
    if(l.CARGO) cargos.add(l.CARGO.trim());
    if(l.SRE) sres.add(l.SRE.trim());
  });

  preencherSelect("selCargo",[...cargos].sort(),"Selecione o Cargo");
  preencherSelect("selSRE",[...sres].sort(),"Selecione a SRE");

  selCargo.disabled=false;
  selSRE.disabled=false;
}

function preencherSelect(id,lista,txt){
  const s=document.getElementById(id);
  s.innerHTML=`<option value="">${txt}</option>`;
  lista.forEach(v=>s.innerHTML+=`<option>${v}</option>`);
}

function aplicarFiltro(){
  const cargo=selCargo.value, sre=selSRE.value;
  if(!cargo||!sre){alert("Selecione Cargo e SRE");return;}

  const filtrados=todosDados.filter(d=>
    d.CARGO?.trim()==cargo && d.SRE?.trim()==sre &&
    d.NOME.toLowerCase().includes(busca.value.toLowerCase())
  );

  const tbody=document.getElementById("tbody-resultados");
  tbody.innerHTML="";
  document.getElementById("tabela-container").style.display="block";

  document.getElementById("resultado-msg").innerText=
    filtrados.length+" resultados encontrados.";

  filtrados.forEach(d=>{
    const cls=d.SITUACAO?.toLowerCase().includes("aprovado")?
      "status-aprovado":"status-outro";
    tbody.insertAdjacentHTML("beforeend",`
      <tr>
        <td>${d.ORDEM}</td>
        <td><strong>${d.NOME}</strong></td>
        <td>${d.CARGO}</td>
        <td>${d.SRE}</td>
        <td>${d.OBJETIVA||"-"}</td>
        <td>${d.REDACAO||"-"}</td>
        <td>${d.TITULOS||"-"}</td>
        <td><b>${d.TOTAL}</b></td>
        <td><span class="${cls}">${d.SITUACAO}</span></td>
      </tr>
    `);
  });
}

function copiarPix(){
  navigator.clipboard.writeText("pauloguimor@yahoo.com.br");
  alert("Chave PIX copiada!");
}
</script>

</body>
</html>
